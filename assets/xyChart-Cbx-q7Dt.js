import{uC as B,uD as g,uE as W,uF as S,uG as T,uH as D,uI as G,uJ as C,uK as U,uL as fe,n6 as ce,uM as he,uN as q,uO as ge,uP as me,uQ as be,uR as ke,uS as _e}from"./index-qfgUZRRO.js";import{uT as ye,uU as Pe}from"./index-qfgUZRRO.js";function Z(a){return typeof a=="object"&&"length"in a?a:Array.from(a)}function $(a){this._context=a}$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(a,e){switch(a=+a,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,e):this._context.moveTo(a,e);break;case 1:this._point=2;default:this._context.lineTo(a,e);break}}};function ee(a){return new $(a)}function te(a){return a[0]}function ie(a){return a[1]}function se(a,e){var t=g(!0),s=null,f=ee,h=null,p=B(l);a=typeof a=="function"?a:a===void 0?te:g(a),e=typeof e=="function"?e:e===void 0?ie:g(e);function l(u){var n,o=(u=Z(u)).length,i,r=!1,c;for(s==null&&(h=f(c=p())),n=0;n<=o;++n)!(n<o&&t(i=u[n],n,u))===r&&((r=!r)?h.lineStart():h.lineEnd()),r&&h.point(+a(i,n,u),+e(i,n,u));if(c)return h=null,c+""||null}return l.x=function(u){return arguments.length?(a=typeof u=="function"?u:g(+u),l):a},l.y=function(u){return arguments.length?(e=typeof u=="function"?u:g(+u),l):e},l.defined=function(u){return arguments.length?(t=typeof u=="function"?u:g(!!u),l):t},l.curve=function(u){return arguments.length?(f=u,s!=null&&(h=f(s)),l):f},l.context=function(u){return arguments.length?(u==null?s=h=null:h=f(s=u),l):s},l}function pe(a,e,t){var s=null,f=g(!0),h=null,p=ee,l=null,u=B(n);a=typeof a=="function"?a:a===void 0?te:g(+a),e=typeof e=="function"?e:e===void 0?g(0):g(+e),t=typeof t=="function"?t:t===void 0?ie:g(+t);function n(i){var r,c,m,P=(i=Z(i)).length,b,_=!1,x,v=new Array(P),y=new Array(P);for(h==null&&(l=p(x=u())),r=0;r<=P;++r){if(!(r<P&&f(b=i[r],r,i))===_)if(_=!_)c=r,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=r-1;m>=c;--m)l.point(v[m],y[m]);l.lineEnd(),l.areaEnd()}_&&(v[r]=+a(b,r,i),y[r]=+e(b,r,i),l.point(s?+s(b,r,i):v[r],t?+t(b,r,i):y[r]))}if(x)return l=null,x+""||null}function o(){return se().defined(f).curve(p).context(h)}return n.x=function(i){return arguments.length?(a=typeof i=="function"?i:g(+i),s=null,n):a},n.x0=function(i){return arguments.length?(a=typeof i=="function"?i:g(+i),n):a},n.x1=function(i){return arguments.length?(s=i==null?null:typeof i=="function"?i:g(+i),n):s},n.y=function(i){return arguments.length?(e=typeof i=="function"?i:g(+i),t=null,n):e},n.y0=function(i){return arguments.length?(e=typeof i=="function"?i:g(+i),n):e},n.y1=function(i){return arguments.length?(t=i==null?null:typeof i=="function"?i:g(+i),n):t},n.lineX0=n.lineY0=function(){return o().x(a).y(e)},n.lineY1=function(){return o().x(a).y(t)},n.lineX1=function(){return o().x(s).y(e)},n.defined=function(i){return arguments.length?(f=typeof i=="function"?i:g(!!i),n):f},n.curve=function(i){return arguments.length?(p=i,h!=null&&(l=p(h)),n):p},n.context=function(i){return arguments.length?(i==null?h=l=null:l=p(h=i),n):h},n}class V extends W{constructor(){super(...arguments),Object.defineProperty(this,"_endIndex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:se()}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:pe()}),Object.defineProperty(this,"_legendStroke",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_legendFill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strokes",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new S(T.new({}),()=>D._new(this._root,{themeTags:G(this.strokes.template.get("themeTags",[]),["line","series","stroke"])},[this.strokes.template])))}),Object.defineProperty(this,"fills",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new S(T.new({}),()=>D._new(this._root,{themeTags:G(this.strokes.template.get("themeTags",[]),["line","series","fill"])},[this.fills.template])))}),Object.defineProperty(this,"_fillTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_previousPoint",{enumerable:!0,configurable:!0,writable:!0,value:[0,0,0,0]}),Object.defineProperty(this,"_dindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_sindex",{enumerable:!0,configurable:!0,writable:!0,value:0})}_afterNew(){this._fillGenerator.y0(function(e){return e[3]}),this._fillGenerator.x0(function(e){return e[2]}),this._fillGenerator.y1(function(e){return e[1]}),this._fillGenerator.x1(function(e){return e[0]}),super._afterNew()}makeStroke(e){const t=this.mainContainer.children.push(e.make());return e.push(t),t}makeFill(e){const t=this.mainContainer.children.push(e.make());return e.push(t),t}_updateChildren(){this._strokeTemplate=void 0,this._fillTemplate=void 0;let e=this.get("xAxis"),t=this.get("yAxis");if(this.isDirty("stroke")){const s=this.get("stroke");this.strokes.template.set("stroke",s);const f=this._legendStroke;f&&f.states.lookup("default").set("stroke",s)}if(this.isDirty("fill")){const s=this.get("fill");this.fills.template.set("fill",s);const f=this._legendFill;f&&f.states.lookup("default").set("fill",s)}if(this.isDirty("fillPattern")){const s=this.get("fillPattern");this.fills.template.set("fillPattern",s);const f=this._legendFill;f&&f.states.lookup("default").set("fillPattern",s)}if(this.isDirty("curveFactory")){const s=this.get("curveFactory");s&&(this._strokeGenerator.curve(s),this._fillGenerator.curve(s))}if(e.inited&&t.inited){if(this._axesDirty||this._valuesDirty||this._stackDirty||this.isDirty("vcx")||this.isDirty("vcy")||this._sizeDirty||this.isDirty("connect")||this.isDirty("curveFactory")){this.fills.each(o=>{o.setPrivate("visible",!1)}),this.strokes.each(o=>{o.setPrivate("visible",!1)}),this.axisRanges.each(o=>{let i=o.fills;i&&i.each(c=>{c.setPrivate("visible",!1)});let r=o.strokes;r&&r.each(c=>{c.setPrivate("visible",!1)})});let s=this.startIndex(),f=this.strokes.template.get("templateField"),h=this.fills.template.get("templateField"),p=!0,l=!0;f&&(p=!1),h&&(l=!1);for(let o=s-1;o>=0;o--){let i=this.dataItems[o],r=!0,c=i.dataContext;if(f&&c[f]&&(p=!0),h&&c[h]&&(l=!0),C(this._valueFields,m=>{q(i.get(m))||(r=!1)}),r&&p&&l){s=o;break}}let u=this.dataItems.length,n=this.endIndex();if(n<u){n++;for(let o=n;o<u;o++){let i=this.dataItems[o],r=!0;if(C(this._valueFields,c=>{q(i.get(c))||(r=!1)}),r){n=o+1;break}}}if(s>0&&s--,this._endIndex=n,this._clearGraphics(),this._sindex=0,this._dindex=s,this.dataItems.length==1)this._startSegment(0);else for(;this._dindex<n-1;)this._startSegment(this._dindex),this._sindex++}}else this._skipped=!0;super._updateChildren()}_clearGraphics(){this.strokes.clear(),this.fills.clear(),this.axisRanges.each(e=>{e.fills.clear(),e.strokes.clear()})}_startSegment(e){let t=this._endIndex,s=t;const f=this.get("autoGapCount"),h=this.get("connect"),p=this.makeFill(this.fills),l=this._fillTemplate,u=this.fills.template;l&&l!=u&&(p.template=l),p.setPrivate("visible",!0);const n=this.makeStroke(this.strokes),o=this._strokeTemplate;o&&o!=this.strokes.template&&(n.template=o),n.setPrivate("visible",!0);let i=this.get("xAxis"),r=this.get("yAxis"),c=this.get("baseAxis"),m=this.get("vcx",1),P=this.get("vcy",1),b=this._xField,_=this._yField,x=this._xOpenField,v=this._yOpenField;const y=this.get("openValueXField"),E=this.get("openValueYField");y||(x=this._xField),E||(v=this._yField);const R=this.get("stacked"),ne=i.basePosition(),le=r.basePosition();let j;c===r?j=this._yField:j=this._xField;const w=[];let A=[];w.push(A);const M=this.strokes.template.get("templateField"),H=this.fills.template.get("templateField");let z=this.get("locationX",.5),J=this.get("locationY",.5),re=this.get("openLocationX",z),ae=this.get("openLocationY",J);const oe=this.get("minDistance",0);let k,K=this.fills.template.get("visible");this.axisRanges.length>0&&(K=!0);let Q=!1;(R||y||E)&&(Q=!0);const I={points:A,segments:w,stacked:R,getOpen:Q,basePosX:ne,basePosY:le,fillVisible:K,xField:b,yField:_,xOpenField:x,yOpenField:v,vcx:m,vcy:P,baseAxis:c,xAxis:i,yAxis:r,locationX:z,locationY:J,openLocationX:re,openLocationY:ae,minDistance:oe};let O=this._strokeTemplate,L=this._fillTemplate;for(k=e;k<s;k++){this._dindex=k;const F=this._dataItems[k];let X=F.get(b),N=F.get(_);if(X==null||N==null?h||(A=[],w.push(A),I.points=A):this._getPoints(F,I),M){let d=F.dataContext[M];if(d)if(d instanceof T||(d=T.new(d)),this._strokeTemplate=d,k>e){s=k;break}else O=d,n.template=d}if(H){let d=F.dataContext[H];if(d)if(d instanceof T||(d=T.new(d)),this._fillTemplate=d,k>e){s=k;break}else L=d,p.template=d}if(!h){let d=this.dataItems[k+1];d&&c.shouldGap(F,d,f,j)&&(A=[],w.push(A),I.points=A)}}p.setRaw("userData",[e,k]),n.setRaw("userData",[e,k]),k===t&&this._endLine(A,w[0][0]),n&&this._drawStroke(n,w),p&&this._drawFill(p,w),this.axisRanges.each(F=>{const X=F.container,N=F.fills,d=this.makeFill(N);X&&X.children.push(d),d.setPrivate("visible",!0),this._drawFill(d,w);const ue=F.strokes,Y=this.makeStroke(ue);X&&X.children.push(Y),O&&O!=this.strokes.template&&(Y.template=O),L&&L!=this.fills.template&&(d.template=L),Y.setPrivate("visible",!0),this._drawStroke(Y,w),d.setRaw("userData",[e,k]),Y.setRaw("userData",[e,k])})}_getPoints(e,t){let s=t.points,f=e.get("locationX",t.locationX),h=e.get("locationY",t.locationY);const p=this.get("exactLocationX",!1),l=this.get("exactLocationY",!1);let u=t.xAxis.getDataItemPositionX(e,t.xField,f,t.vcx,p),n=t.yAxis.getDataItemPositionY(e,t.yField,h,t.vcy,l);if(this._shouldInclude(u)){const o=this.getPoint(u,n),i=[o.x,o.y];if(o.x+=this._x,o.y+=this._y,e.set("point",o),t.fillVisible){let r=u,c=n;if(t.baseAxis===t.xAxis?c=t.basePosY:t.baseAxis===t.yAxis&&(r=t.basePosX),t.getOpen){let P=e.get(t.xOpenField),b=e.get(t.yOpenField);if(P!=null&&b!=null){let _=e.get("openLocationX",t.openLocationX),x=e.get("openLocationY",t.openLocationY);if(t.stacked){let v=e.get("stackToItemX"),y=e.get("stackToItemY");v?(r=t.xAxis.getDataItemPositionX(v,t.xField,_,v.component.get("vcx"),p),U(r)&&(r=t.basePosX)):t.yAxis===t.baseAxis?r=t.basePosX:r=t.xAxis.getDataItemPositionX(e,t.xOpenField,_,t.vcx,p),y?(c=t.yAxis.getDataItemPositionY(y,t.yField,x,y.component.get("vcy"),l),U(c)&&(c=t.basePosY)):t.xAxis===t.baseAxis?c=t.basePosY:c=t.yAxis.getDataItemPositionY(e,t.yOpenField,x,t.vcy,l)}else r=t.xAxis.getDataItemPositionX(e,t.xOpenField,_,t.vcx,p),c=t.yAxis.getDataItemPositionY(e,t.yOpenField,x,t.vcy,l)}}let m=this.getPoint(r,c);i[2]=m.x,i[3]=m.y}if(t.minDistance>0){const r=i[0],c=i[1],m=i[2],P=i[3],b=this._previousPoint,_=b[0],x=b[1],v=b[2],y=b[3];(Math.hypot(r-_,c-x)>t.minDistance||m&&P&&Math.hypot(m-v,P-y)>t.minDistance)&&(s.push(i),this._previousPoint=i)}else s.push(i)}}_endLine(e,t){}_drawStroke(e,t){e.get("visible")&&!e.get("forceHidden")&&e.set("draw",s=>{C(t,f=>{this._strokeGenerator.context(s),this._strokeGenerator(f)})})}_drawFill(e,t){e.get("visible")&&!e.get("forceHidden")&&e.set("draw",s=>{C(t,f=>{this._fillGenerator.context(s),this._fillGenerator(f)})})}_processAxisRange(e){super._processAxisRange(e),e.fills=new S(T.new({}),()=>D._new(this._root,{themeTags:G(e.fills.template.get("themeTags",[]),["line","series","fill"])},[this.fills.template,e.fills.template])),e.strokes=new S(T.new({}),()=>D._new(this._root,{themeTags:G(e.strokes.template.get("themeTags",[]),["line","series","stroke"])},[this.strokes.template,e.strokes.template]))}createLegendMarker(e){const t=this.get("legendDataItem");if(t){const s=t.get("marker"),f=t.get("markerRectangle");f&&f.setPrivate("visible",!1),s.set("background",fe.new(s._root,{fillOpacity:0,fill:ce(0)}));const h=s.children.push(D._new(s._root,{themeTags:["line","series","legend","marker","stroke"],interactive:!1},[this.strokes.template]));this._legendStroke=h;const p=s.children.push(D._new(s._root,{themeTags:["line","series","legend","marker","fill"]},[this.fills.template]));this._legendFill=p;const l=this._root.interfaceColors.get("disabled");if(h.states.create("disabled",{fill:l,stroke:l}),p.states.create("disabled",{fill:l,stroke:l}),this.bullets.length>0){const u=this.bullets.getIndex(0);if(u){const n=u(s._root,this,new he(this,{legend:!0},{}));if(n){const o=n.get("sprite");o instanceof D&&o.states.create("disabled",{fill:l,stroke:l}),o&&(o.setAll({tooltipText:void 0,tooltipHTML:void 0,focusable:void 0,focusableGroup:void 0,ariaLabel:void 0}),s.children.push(o),o.setAll({x:s.width()/2,y:s.height()/2}),s.events.on("boundschanged",()=>{o.setAll({x:s.width()/2,y:s.height()/2})}))}}}}}}Object.defineProperty(V,"className",{enumerable:!0,configurable:!0,writable:!0,value:"LineSeries"});Object.defineProperty(V,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:W.classNames.concat([V.className])});export{be as AxisRendererXAm5,_e as AxisRendererYAm5,me as CategoryAxisAm5,ge as ColumnSeriesAm5,V as LineSeriesAm5,ke as ValueAxisAm5,ye as XYChartAm5,Pe as XYCursorAm5};
